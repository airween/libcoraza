Author of original code:

    Juan Pablo Tosso <jptosso@gmail.com>

The foreign parts of code and its source are marked with comment.